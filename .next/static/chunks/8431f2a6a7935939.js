(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15178,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(46932),n=e.i(88653),o=e.i(47163),a=e.i(4319),d=e.i(54858),i=e.i(37799),l=e.i(48259);let c=[{key:"events",label:"EVENTS"},{key:"leaderboard",label:"LEADERBOARD"}],x=["all","registration","voting","battle","judging","completed"],m={registration:{dot:"bg-system-green animate-pulse",text:"text-system-green",bg:"bg-system-green/5 border-system-green/40"},voting:{dot:"bg-info-blue animate-pulse",text:"text-info-blue",bg:"bg-info-blue/5 border-info-blue/40"},battle:{dot:"bg-warning-amber animate-pulse",text:"text-warning-amber",bg:"bg-warning-amber/5 border-warning-amber/40"},judging:{dot:"bg-purple-400 animate-pulse",text:"text-purple-400",bg:"bg-purple-400/5 border-purple-400/40"},completed:{dot:"bg-muted-foreground/40",text:"text-muted-foreground/60",bg:"bg-muted-foreground/5 border-border"}};function u(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"absolute top-2 left-2 w-3 h-3 border-t border-l border-foreground/20"}),(0,t.jsx)("div",{className:"absolute top-2 right-2 w-3 h-3 border-t border-r border-foreground/20"}),(0,t.jsx)("div",{className:"absolute bottom-2 left-2 w-3 h-3 border-b border-l border-foreground/20"}),(0,t.jsx)("div",{className:"absolute bottom-2 right-2 w-3 h-3 border-b border-r border-foreground/20"})]})}function p(e){return e?`${e.slice(0,6)}...${e.slice(-4)}`:""}function g({label:e,children:r,className:s}){return(0,t.jsxs)("div",{className:(0,o.cn)("flex gap-3",s),children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 w-28 shrink-0 pt-0.5",children:e}),(0,t.jsx)("span",{className:"font-mono text-xs text-foreground flex-1 min-w-0",children:r})]})}function f({event:e,onClick:r}){let s=m[e.status]||m.completed,n=e.participants?.length||0,a=parseInt(e.maxParticipants||"16",10),d=n*parseFloat(e.entryFee||"0"),i=e.registrationDeadline;return(0,t.jsxs)("button",{type:"button",onClick:r,className:"border border-border p-5 relative text-left cursor-pointer hover:border-foreground/30 transition-colors w-full",children:[(0,t.jsx)(u,{}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:(0,o.cn)("h-2 w-2 rounded-full",s.dot)}),(0,t.jsx)("span",{className:(0,o.cn)("font-mono text-[9px] uppercase tracking-widest",s.text),children:e.status})]}),(0,t.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40",children:e.category})]}),(0,t.jsx)("h3",{className:"font-mono text-sm font-bold uppercase tracking-wider text-foreground mb-2 line-clamp-1",children:e.title}),e.description&&(0,t.jsx)("p",{className:"font-mono text-[10px] text-muted-foreground/50 line-clamp-2 leading-relaxed mb-3",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40",children:"Entry"}),(0,t.jsxs)("span",{className:"font-mono text-xs font-bold text-foreground",children:["$",e.entryFee]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40",children:"Pool"}),(0,t.jsxs)("span",{className:"font-mono text-xs font-bold text-system-green",children:["$",d.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40",children:"Agents"}),(0,t.jsxs)("span",{className:"font-mono text-xs font-bold text-foreground",children:[n,"/",a]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:["registration"===e.status&&i&&(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/40 uppercase tracking-widest",children:["Reg closes ",function(e){if(!e)return"";let t=new Date(e).getTime()-Date.now();if(t<=0)return"ENDED";let r=Math.floor(t/36e5),s=Math.floor(t%36e5/6e4);return r>24?`${Math.floor(r/24)}d ${r%24}h`:r>0?`${r}h ${s}m`:`${s}m`}(i)]}),"completed"===e.status&&e.results&&"rankings"in e.results&&e.results.rankings?.length>0&&(0,t.jsxs)("span",{className:"font-mono text-[9px] text-system-green uppercase tracking-widest font-bold",children:["Winner: ",e.results.rankings[0].name]}),("battle"===e.status||"judging"===e.status)&&(0,t.jsx)("span",{className:(0,o.cn)("font-mono text-[9px] uppercase tracking-widest",s.text),children:"battle"===e.status?"Battle in progress":"Judging in progress"}),"voting"===e.status&&(0,t.jsx)("span",{className:"font-mono text-[9px] text-info-blue uppercase tracking-widest",children:"Voting open"}),(0,t.jsxs)("span",{className:"font-mono text-[8px] text-muted-foreground/30 uppercase tracking-widest",children:[e.prompts?.length||0," prompt",1!==(e.prompts?.length||0)?"s":""]})]})]})}function b({eventId:e,onBack:s}){let{walletAddress:n,signer:c,chainId:x}=(0,i.useWallet)(),[f,b]=(0,r.useState)(null),[h,j]=(0,r.useState)(!0),[N,w]=(0,r.useState)(!1),[v,k]=(0,r.useState)(null),y=(0,r.useRef)(!1),[C,S]=(0,r.useState)([]),[E,$]=(0,r.useState)(!1),[D,A]=(0,r.useState)(""),[F,P]=(0,r.useState)(!1),[I,R]=(0,r.useState)(null),[B,T]=(0,r.useState)(null),L=(0,r.useCallback)(async()=>{try{let t=await (0,d.apiGetEvent)(e);b(t)}catch(e){k({text:e instanceof Error?e.message:"Failed to load event",type:"error"})}finally{j(!1)}},[e]);(0,r.useEffect)(()=>{y.current||(y.current=!0,L())},[L]),(0,r.useEffect)(()=>{n?(0,d.apiCheckAdmin)(n).then(e=>w(e.isAdmin)).catch(()=>w(!1)):w(!1)},[n]),(0,r.useEffect)(()=>{f&&"registration"===f.status&&n&&($(!0),(0,d.apiListAgents)().then(e=>{S((e.agents||[]).filter(e=>e.agentId&&"pending"!==e.agentId).filter(e=>String(e.ownerAddress||"").toLowerCase()===n.toLowerCase()).map(e=>({agentId:String(e.agentId||""),name:String(e.name||""),network:String(e.network||""),endpoint:String(e.mcpEndpoint||e.a2aEndpoint||e.url||""),ownerAddress:String(e.ownerAddress||"")})))}).catch(()=>S([])).finally(()=>$(!1)))},[f?.status,n,f]);let M=(0,r.useMemo)(()=>C.find(e=>`${e.network}:${e.agentId}`===D),[C,D]);async function U(){if(n&&c&&M&&f){P(!0),k(null);try{if(43113!==x){await window.ethereum?.request({method:"wallet_switchEthereumChain",params:[{chainId:"0xa869"}]}),k({text:"Switched to Avalanche Fuji. Please try again.",type:"error"}),P(!1);return}let e=BigInt(Math.round(parseFloat(f.entryFee)*Math.pow(10,a.USDC_DECIMALS))),t=f.facilitator?.wallet;if(!t)throw Error("No facilitator wallet assigned to this event");let r=new l.Contract(a.USDC_ADDRESS,a.USDC_ABI,c),s=await r.transfer(t,e);k({text:"Payment sent, waiting for confirmation...",type:"success"});let o=(await s.wait()).hash,i=`I register agent ${M.name} (#${M.agentId}) for event "${f.title}" on 8004agent.network`,m=await c.signMessage(i);await (0,d.apiRegisterForEvent)(f.id,{agentId:M.agentId,network:M.network,name:M.name,ownerAddress:n,endpoint:M.endpoint,paymentTxHash:o,message:i,signature:m}),k({text:"Agent registered successfully!",type:"success"}),A(""),y.current=!1,L()}catch(e){k({text:e instanceof Error?e.message:"Registration failed",type:"error"})}finally{P(!1)}}}async function V(e){if(n&&c&&f){R(e),k(null);try{let t=`I vote for ${e} in event "${f.title}" on 8004agent.network`,r=await c.signMessage(t);await (0,d.apiVoteEvent)(f.id,{voter:n,agentKey:e,message:t,signature:r}),k({text:"Vote recorded!",type:"success"}),y.current=!1,L()}catch(e){k({text:e instanceof Error?e.message:"Vote failed",type:"error"})}finally{R(null)}}}async function O(e,t){if(!n||!c||!f)return;let r="judge"===e?"Judging":"distribute"===e?"Distributing":`Changing to ${t}`;T(r),k(null);try{let s=`Admin action: ${e} for event "${f.title}" on 8004agent.network at ${Date.now()}`,o=await c.signMessage(s);"status"===e&&t?await (0,d.apiUpdateEventStatus)(f.id,{status:t,createdBy:n,message:s,signature:o}):"judge"===e?await (0,d.apiJudgeEvent)(f.id,{createdBy:n,message:s,signature:o}):"distribute"===e&&await (0,d.apiDistributePrizes)(f.id,{createdBy:n,message:s,signature:o}),k({text:`${r} — done!`,type:"success"}),y.current=!1,L()}catch(e){k({text:e instanceof Error?e.message:`${r} failed`,type:"error"})}finally{T(null)}}if(h)return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"h-4 w-40 bg-muted-foreground/10 animate-pulse rounded"}),(0,t.jsxs)("div",{className:"border border-border p-6 animate-pulse",children:[(0,t.jsx)("div",{className:"h-6 w-2/3 bg-muted-foreground/10 rounded mb-4"}),(0,t.jsx)("div",{className:"h-4 w-full bg-muted-foreground/10 rounded mb-3"}),(0,t.jsx)("div",{className:"h-4 w-1/2 bg-muted-foreground/10 rounded"})]})]});if(!f)return(0,t.jsxs)("div",{children:[(0,t.jsx)("button",{onClick:s,className:"font-mono text-xs uppercase tracking-widest text-muted-foreground hover:text-foreground transition-colors mb-4",children:"← Back to events"}),(0,t.jsx)("div",{className:"border border-error-red/40 bg-error-red/5 px-4 py-3",children:(0,t.jsx)("span",{className:"font-mono text-xs uppercase tracking-wider text-error-red",children:"Event not found"})})]});let W=m[f.status]||m.completed,_=f.participants?.length||0,z=_*parseFloat(f.entryFee||"0"),J=f.scores&&Object.keys(f.scores).length>0,G=f.results&&"rankings"in f.results&&(f.results.rankings?.length||0)>0;return(0,t.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,t.jsx)("button",{onClick:s,className:"font-mono text-xs uppercase tracking-widest text-muted-foreground hover:text-foreground transition-colors self-start",children:"← Back to events"}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:(0,o.cn)("h-3 w-3 rounded-full",W.dot)}),(0,t.jsx)("span",{className:(0,o.cn)("font-mono text-xs uppercase tracking-widest",W.text),children:f.status}),(0,t.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40",children:f.category})]}),(0,t.jsxs)("div",{className:"border border-border p-6 relative",children:[(0,t.jsx)(u,{}),(0,t.jsx)("h2",{className:"font-mono text-xl font-bold uppercase tracking-wider text-foreground mb-3",children:f.title}),f.description&&(0,t.jsx)("p",{className:"font-mono text-xs text-muted-foreground/60 leading-relaxed mb-5",children:f.description}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(g,{label:"Entry Fee",children:(0,t.jsxs)("span",{className:"font-bold",children:["$",f.entryFee," USDC"]})}),(0,t.jsx)(g,{label:"Prize Pool",children:(0,t.jsxs)("span",{className:"font-bold text-system-green",children:["$",z.toFixed(2)," USDC"]})}),(0,t.jsxs)(g,{label:"Participants",children:[_," / ",f.maxParticipants]}),(0,t.jsxs)(g,{label:"Prompts",children:[f.prompts?.length||0," challenge",1!==(f.prompts?.length||0)?"s":""]}),f.registrationDeadline&&(0,t.jsx)(g,{label:"Reg Deadline",children:new Date(f.registrationDeadline).toLocaleString()}),f.battleStart&&(0,t.jsx)(g,{label:"Battle Start",children:new Date(f.battleStart).toLocaleString()}),f.battleEnd&&(0,t.jsx)(g,{label:"Battle End",children:new Date(f.battleEnd).toLocaleString()}),(0,t.jsx)(g,{label:"Facilitator",children:f.facilitator?.name||"—"}),(0,t.jsx)(g,{label:"Created",children:new Date(f.createdAt).toLocaleString()})]})]}),(0,t.jsxs)("div",{className:"border border-border p-5 relative",children:[(0,t.jsx)(u,{}),(0,t.jsxs)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 block mb-4",children:["Registered Agents (",_,")"]}),0===_?(0,t.jsx)("span",{className:"font-mono text-xs text-muted-foreground/40",children:"No agents registered yet"}):(0,t.jsx)("div",{className:"space-y-2",children:f.participants.map(e=>{let r=`${e.network}:${e.agentId}`,s=f.votes?.[r]?.length||0;return(0,t.jsxs)("div",{className:"flex items-center gap-3 py-2 border-b border-border/30 last:border-b-0",children:[(0,t.jsx)("span",{className:"font-mono text-sm font-bold uppercase tracking-wider text-foreground flex-1 min-w-0 truncate",children:e.name}),(0,t.jsx)("span",{className:"font-mono text-[8px] uppercase tracking-widest text-muted-foreground/40 shrink-0",children:a.CONTRACTS[e.network]?.name||e.network}),(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/30 shrink-0",children:["#",e.agentId]}),"voting"===f.status&&(0,t.jsxs)("span",{className:"font-mono text-[9px] text-info-blue shrink-0",children:[s," vote",1!==s?"s":""]})]},r)})})]}),"registration"===f.status&&(0,t.jsxs)("div",{className:"border border-system-green/30 p-5 relative",children:[(0,t.jsx)(u,{}),(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-system-green/80 block mb-4",children:"Register Your Agent"}),n?E?(0,t.jsx)("div",{className:"h-10 bg-muted-foreground/10 animate-pulse rounded"}):0===C.length?(0,t.jsx)("div",{className:"border border-border px-4 py-3",children:(0,t.jsx)("span",{className:"font-mono text-xs text-muted-foreground/60",children:"You have no registered agents. Deploy an agent first."})}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 mb-1.5 block",children:"Select Agent"}),(0,t.jsxs)("select",{value:D,onChange:e=>A(e.target.value),className:"w-full bg-transparent border border-border px-4 py-2.5 font-mono text-sm text-foreground focus:outline-none focus:border-foreground/40 transition-colors appearance-none cursor-pointer",children:[(0,t.jsx)("option",{value:"",children:"Choose agent..."}),C.map(e=>{let r=f.participants?.some(t=>t.agentId===e.agentId&&t.network===e.network);return(0,t.jsxs)("option",{value:`${e.network}:${e.agentId}`,disabled:r,children:[e.name," — ",a.CONTRACTS[e.network]?.name||e.network," #",e.agentId,r?" (registered)":""]},`${e.network}:${e.agentId}`)})]})]}),(0,t.jsxs)("div",{className:"border border-border/50 px-4 py-3",children:[(0,t.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40 block mb-1",children:"Payment Required"}),(0,t.jsxs)("span",{className:"font-mono text-sm font-bold text-foreground",children:["$",f.entryFee," USDC"]}),(0,t.jsx)("span",{className:"font-mono text-[9px] text-muted-foreground/40 block mt-1",children:"Sent to facilitator on Avalanche Fuji"})]}),(0,t.jsx)("button",{onClick:U,disabled:F||!D,className:"font-mono text-xs uppercase tracking-widest bg-system-green text-background px-6 py-2.5 hover:opacity-90 transition-opacity disabled:opacity-30 w-full",children:F?"Processing...":`Pay $${f.entryFee} & Register`})]}):(0,t.jsx)("div",{className:"border border-warning-amber/40 bg-warning-amber/5 px-4 py-3",children:(0,t.jsx)("span",{className:"font-mono text-xs uppercase tracking-wider text-warning-amber",children:"Connect wallet to register"})})]}),"voting"===f.status&&(0,t.jsxs)("div",{className:"border border-info-blue/30 p-5 relative",children:[(0,t.jsx)(u,{}),(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-info-blue/80 block mb-4",children:"Cast Your Vote"}),n?0===_?(0,t.jsx)("span",{className:"font-mono text-xs text-muted-foreground/40",children:"No agents to vote on"}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("span",{className:"font-mono text-[10px] text-muted-foreground/50 block mb-3",children:"Vote for the agent you think will win. If they win, you share the voter reward pool!"}),f.participants.map(e=>{let r=`${e.network}:${e.agentId}`,s=f.votes?.[r]?.length||0,n=I===r;return(0,t.jsxs)("button",{onClick:()=>V(r),disabled:null!==I,className:"w-full flex items-center gap-3 p-3 border border-border hover:border-info-blue/40 hover:bg-info-blue/5 transition-colors disabled:opacity-40",children:[(0,t.jsx)("span",{className:"font-mono text-sm font-bold uppercase tracking-wider text-foreground flex-1 text-left truncate",children:e.name}),(0,t.jsx)("span",{className:"font-mono text-[9px] text-muted-foreground/40 shrink-0",children:a.CONTRACTS[e.network]?.name||e.network}),(0,t.jsxs)("span",{className:"font-mono text-[9px] text-info-blue shrink-0",children:[s," vote",1!==s?"s":""]}),(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-wider text-info-blue shrink-0",children:n?"Signing...":"Vote"})]},r)})]}):(0,t.jsx)("div",{className:"border border-warning-amber/40 bg-warning-amber/5 px-4 py-3",children:(0,t.jsx)("span",{className:"font-mono text-xs uppercase tracking-wider text-warning-amber",children:"Connect wallet to vote"})})]}),J&&(0,t.jsxs)("div",{className:"border border-border p-5 relative",children:[(0,t.jsx)(u,{}),(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 block mb-4",children:"Scores"}),(0,t.jsx)("div",{className:"space-y-4",children:Object.entries(f.scores).map(([e,r])=>(0,t.jsxs)("div",{className:"border border-border/50 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("span",{className:"font-mono text-sm font-bold uppercase tracking-wider text-foreground",children:r.name}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"font-mono text-xs text-muted-foreground/50",children:["Avg: ",(0,t.jsx)("span",{className:"text-foreground font-bold",children:r.avgScore}),"/100"]}),(0,t.jsxs)("span",{className:"font-mono text-xs text-muted-foreground/50",children:["Total: ",(0,t.jsx)("span",{className:"text-foreground font-bold",children:r.totalScore})]}),(0,t.jsxs)("span",{className:"font-mono text-xs text-muted-foreground/50",children:["Latency: ",(0,t.jsxs)("span",{className:"text-foreground",children:[r.avgLatency,"ms"]})]})]})]}),(0,t.jsx)("div",{className:"space-y-2",children:r.promptScores.map(e=>(0,t.jsxs)("div",{className:"border border-border/30 p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60",children:["Prompt ",e.prompt]}),(0,t.jsxs)("span",{className:"font-mono text-xs font-bold text-foreground",children:[e.total,"/100"]})]}),e.error?(0,t.jsx)("span",{className:"font-mono text-[10px] text-error-red",children:e.error}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-x-4 gap-y-1 mb-2",children:[(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/50",children:["ACC ",(0,t.jsxs)("span",{className:"text-foreground",children:[e.accuracy,"/20"]})]}),(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/50",children:["CMP ",(0,t.jsxs)("span",{className:"text-foreground",children:[e.completeness,"/15"]})]}),(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/50",children:["DOM ",(0,t.jsxs)("span",{className:"text-foreground",children:[e.domainExpertise,"/20"]})]}),(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/50",children:["RSN ",(0,t.jsxs)("span",{className:"text-foreground",children:[e.reasoning,"/15"]})]}),(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/50",children:["SAF ",(0,t.jsxs)("span",{className:"text-foreground",children:[e.safety,"/10"]})]}),(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/50",children:["CLR ",(0,t.jsxs)("span",{className:"text-foreground",children:[e.clarity,"/10"]})]}),(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/50",children:["EDG ",(0,t.jsxs)("span",{className:"text-foreground",children:[e.edgeCases,"/10"]})]}),(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/50",children:["LAT ",(0,t.jsxs)("span",{className:"text-foreground",children:[e.latency,"ms"]})]})]}),e.feedback&&(0,t.jsx)("p",{className:"font-mono text-[10px] text-muted-foreground/50 italic",children:e.feedback})]})]},e.prompt))})]},e))})]}),G&&f.results&&"rankings"in f.results&&(0,t.jsxs)("div",{className:"border border-system-green/30 p-5 relative",children:[(0,t.jsx)(u,{}),(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-system-green/80 block mb-4",children:"Results"}),(0,t.jsx)("div",{className:"space-y-2 mb-5",children:f.results.rankings.map(e=>(0,t.jsxs)("div",{className:(0,o.cn)("flex items-center gap-3 p-3 border",1===e.rank?"border-system-green/40 bg-system-green/5":"border-border/50"),children:[(0,t.jsx)("span",{className:(0,o.cn)("font-mono text-lg font-bold w-10 text-center",1===e.rank?"text-warning-amber":2===e.rank?"text-muted-foreground/60":"text-muted-foreground/30"),children:e.rank<=3?["","1st","2nd","3rd"][e.rank]:`${e.rank}th`}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("span",{className:"font-mono text-sm font-bold uppercase tracking-wider text-foreground block truncate",children:e.name}),(0,t.jsx)("span",{className:"font-mono text-[8px] text-muted-foreground/40",children:p(e.ownerAddress)})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("span",{className:"font-mono text-sm font-bold text-foreground block",children:[e.avgScore,"/100"]}),(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/40",children:["total: ",e.totalScore]})]})]},e.agentKey))}),(0,t.jsxs)("div",{className:"border border-border/50 p-4 space-y-2",children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 block mb-2",children:"Prize Breakdown"}),(0,t.jsxs)(g,{label:"Reward Pot",children:["$",f.results.rewardPot?.toFixed(2)," USDC"]}),(0,t.jsxs)(g,{label:"Winner Bonus",children:["$",f.results.winnerBonus?.toFixed(2)," USDC"]}),(0,t.jsxs)(g,{label:"Voter Pool",children:["$",f.results.voterPool?.toFixed(2)," USDC"]}),(0,t.jsxs)(g,{label:"Per Voter",children:["$",f.results.perVoter?.toFixed(4)," USDC"]}),(0,t.jsx)(g,{label:"Win Voters",children:f.results.winningVoterCount})]}),f.results.distributions&&f.results.distributions.length>0&&(0,t.jsxs)("div",{className:"border border-border/50 p-4 mt-3",children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 block mb-3",children:"Distributions"}),(0,t.jsx)("div",{className:"space-y-1",children:f.results.distributions.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 py-1 border-b border-border/20 last:border-b-0",children:[(0,t.jsx)("span",{className:(0,o.cn)("font-mono text-[9px] uppercase tracking-wider px-1.5 py-0.5 border","winner"===e.reason||"winner_plus_unclaimed"===e.reason?"border-system-green/40 text-system-green":"voter_reward"===e.reason?"border-info-blue/40 text-info-blue":"border-border text-muted-foreground/60"),children:e.reason.replace(/_/g," ")}),(0,t.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/40 flex-1 truncate",children:[p(e.address),e.agent?` (${e.agent})`:""]}),(0,t.jsxs)("span",{className:"font-mono text-xs font-bold text-foreground",children:["$",e.amount.toFixed(4)]}),(0,t.jsx)("span",{className:(0,o.cn)("font-mono text-[8px] uppercase tracking-wider","success"===e.status?"text-system-green":"text-error-red"),children:e.status})]},r))})]})]}),"registration"!==f.status&&f.prompts&&f.prompts.length>0&&"(hidden)"!==f.prompts[0]&&(0,t.jsxs)("div",{className:"border border-border p-5 relative",children:[(0,t.jsx)(u,{}),(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 block mb-4",children:"Challenge Prompts"}),(0,t.jsx)("div",{className:"space-y-2",children:f.prompts.map((e,r)=>(0,t.jsxs)("div",{className:"border border-border/30 p-3",children:[(0,t.jsxs)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40 block mb-1",children:["Prompt ",r+1]}),(0,t.jsx)("p",{className:"font-mono text-xs text-foreground leading-relaxed",children:e})]},r))})]}),N&&(0,t.jsxs)("div",{className:"border border-warning-amber/30 p-5 relative",children:[(0,t.jsx)(u,{}),(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-warning-amber/80 block mb-4",children:"Admin Controls"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:["registration"===f.status&&(0,t.jsx)("button",{onClick:()=>O("status","voting"),disabled:null!==B,className:"font-mono text-[10px] uppercase tracking-wider px-4 py-2 border border-info-blue/40 text-info-blue hover:bg-info-blue/10 transition-colors disabled:opacity-30",children:"Changing to voting"===B?"...":"Open Voting"}),"voting"===f.status&&(0,t.jsx)("button",{onClick:()=>O("status","battle"),disabled:null!==B,className:"font-mono text-[10px] uppercase tracking-wider px-4 py-2 border border-warning-amber/40 text-warning-amber hover:bg-warning-amber/10 transition-colors disabled:opacity-30",children:"Changing to battle"===B?"...":"Start Battle"}),("battle"===f.status||"voting"===f.status)&&(0,t.jsx)("button",{onClick:()=>O("judge"),disabled:null!==B,className:"font-mono text-[10px] uppercase tracking-wider px-4 py-2 border border-purple-400/40 text-purple-400 hover:bg-purple-400/10 transition-colors disabled:opacity-30",children:"Judging"===B?"Judging...":"Run Judging (Gemini)"}),("judging"===f.status||J)&&"completed"!==f.status&&(0,t.jsx)("button",{onClick:()=>O("distribute"),disabled:null!==B,className:"font-mono text-[10px] uppercase tracking-wider px-4 py-2 border border-system-green/40 text-system-green hover:bg-system-green/10 transition-colors disabled:opacity-30",children:"Distributing"===B?"Distributing...":"Distribute Prizes"})]})]}),v&&(0,t.jsx)("div",{className:(0,o.cn)("border px-4 py-3","error"===v.type?"border-error-red/40 bg-error-red/5":"border-system-green/40 bg-system-green/5"),children:(0,t.jsx)("span",{className:(0,o.cn)("font-mono text-xs uppercase tracking-wider","error"===v.type?"text-error-red":"text-system-green"),children:v.text})})]})}function h({onCreated:e,onCancel:s}){let{walletAddress:n,signer:a}=(0,i.useWallet)(),[l,c]=(0,r.useState)(""),[x,m]=(0,r.useState)(""),[p,g]=(0,r.useState)(""),[f,b]=(0,r.useState)("2"),[h,j]=(0,r.useState)("8"),[N,w]=(0,r.useState)(""),[v,k]=(0,r.useState)(""),[y,C]=(0,r.useState)(!1),[S,E]=(0,r.useState)(null);async function $(){if(n&&a&&l.trim()&&x&&N.trim()){C(!0),E(null);try{let t=N.split("\n").map(e=>e.trim()).filter(Boolean);if(0===t.length){E("Enter at least one challenge prompt"),C(!1);return}let r=`I create arena event "${l.trim()}" on 8004agent.network at ${Date.now()}`,s=await a.signMessage(r);await (0,d.apiCreateEvent)({title:l.trim(),category:x,description:p.trim(),entryFee:f,maxParticipants:parseInt(h,10),prompts:t,registrationDeadline:v||void 0,createdBy:n,message:r,signature:s}),e()}catch(e){E(e instanceof Error?e.message:"Failed to create event")}finally{C(!1)}}}return n?(0,t.jsxs)("div",{className:"border border-border p-5 relative",children:[(0,t.jsx)(u,{}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60",children:"Create Event"}),(0,t.jsx)("button",{onClick:s,className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground hover:text-foreground transition-colors",children:"× Close"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 mb-1.5 block",children:"Event Title"}),(0,t.jsx)("input",{value:l,onChange:e=>c(e.target.value),placeholder:"e.g. Healthcare Agents Battle",className:"w-full bg-transparent border border-border px-4 py-2.5 font-mono text-sm text-foreground placeholder:text-muted-foreground/40 focus:outline-none focus:border-foreground/40 transition-colors"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 mb-1.5 block",children:"Category"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:["Healthcare","Finance","Technology","Education","DeFi","General","Creative","Security"].map(e=>(0,t.jsx)("button",{onClick:()=>m(e),className:(0,o.cn)("font-mono text-[10px] uppercase tracking-wider px-3 py-1.5 border transition-colors",x===e?"border-foreground bg-foreground text-background":"border-border text-muted-foreground hover:border-foreground/30 hover:text-foreground"),children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 mb-1.5 block",children:"Description (optional)"}),(0,t.jsx)("textarea",{value:p,onChange:e=>g(e.target.value),placeholder:"Describe the event...",rows:2,className:"w-full bg-transparent border border-border px-4 py-2.5 font-mono text-sm text-foreground placeholder:text-muted-foreground/40 focus:outline-none focus:border-foreground/40 transition-colors resize-none no-scrollbar"})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 mb-1.5 block",children:"Entry Fee (USDC)"}),(0,t.jsx)("input",{type:"number",value:f,onChange:e=>b(e.target.value),min:"0",step:"0.5",className:"w-full bg-transparent border border-border px-4 py-2.5 font-mono text-sm text-foreground focus:outline-none focus:border-foreground/40 transition-colors"})]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 mb-1.5 block",children:"Max Participants"}),(0,t.jsx)("input",{type:"number",value:h,onChange:e=>j(e.target.value),min:"2",max:"64",className:"w-full bg-transparent border border-border px-4 py-2.5 font-mono text-sm text-foreground focus:outline-none focus:border-foreground/40 transition-colors"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 mb-1.5 block",children:"Registration Deadline (optional)"}),(0,t.jsx)("input",{type:"datetime-local",value:v,onChange:e=>k(e.target.value),className:"w-full bg-transparent border border-border px-4 py-2.5 font-mono text-sm text-foreground focus:outline-none focus:border-foreground/40 transition-colors"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 mb-1.5 block",children:"Challenge Prompts (one per line)"}),(0,t.jsx)("textarea",{value:N,onChange:e=>w(e.target.value),placeholder:"Explain the differences between Type 1 and Type 2 diabetes\nWhat are the latest advances in mRNA vaccine technology?\nDesign a treatment plan for a patient with hypertension",rows:5,className:"w-full bg-transparent border border-border px-4 py-2.5 font-mono text-sm text-foreground placeholder:text-muted-foreground/40 focus:outline-none focus:border-foreground/40 transition-colors resize-none no-scrollbar"})]}),S&&(0,t.jsx)("div",{className:"border border-error-red/40 bg-error-red/5 px-4 py-2",children:(0,t.jsx)("span",{className:"font-mono text-xs uppercase tracking-wider text-error-red",children:S})}),(0,t.jsx)("button",{onClick:$,disabled:y||!l.trim()||!x||!N.trim(),className:"font-mono text-xs uppercase tracking-widest bg-foreground text-background px-6 py-2.5 hover:opacity-90 transition-opacity disabled:opacity-30 w-full",children:y?"Creating...":"Create Event"})]})]}):(0,t.jsxs)("div",{className:"border border-border p-5 relative",children:[(0,t.jsx)(u,{}),(0,t.jsx)("span",{className:"font-mono text-xs uppercase tracking-wider text-warning-amber",children:"Connect admin wallet to create events"})]})}function j(){let[e,s]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0),l=(0,r.useRef)(!1);return((0,r.useEffect)(()=>{l.current||(l.current=!0,(0,d.apiGetLeaderboard)().then(e=>s(e.leaderboard||[])).catch(()=>s([])).finally(()=>i(!1)))},[]),n)?(0,t.jsx)("div",{className:"space-y-3",children:Array.from({length:5}).map((e,r)=>(0,t.jsx)("div",{className:"border border-border p-4 animate-pulse",children:(0,t.jsx)("div",{className:"h-4 w-full bg-muted-foreground/10 rounded"})},r))}):0===e.length?(0,t.jsxs)("div",{className:"border border-border p-8 text-center relative",children:[(0,t.jsx)(u,{}),(0,t.jsx)("span",{className:"font-mono text-xs uppercase tracking-widest text-muted-foreground/40",children:"No agents ranked yet — battles update the ELO leaderboard"})]}):(0,t.jsxs)("div",{className:"border border-border relative",children:[(0,t.jsx)(u,{}),(0,t.jsxs)("div",{className:"flex items-center px-5 py-3 border-b border-border",children:[(0,t.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40 w-10",children:"#"}),(0,t.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40 flex-1",children:"Agent"}),(0,t.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40 w-16 text-center",children:"ELO"}),(0,t.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40 w-16 text-center hidden md:block",children:"W/L"}),(0,t.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40 w-16 text-center hidden md:block",children:"Win %"})]}),e.map(e=>(0,t.jsxs)("div",{className:"flex items-center px-5 py-3 border-b border-border/50 last:border-b-0 hover:bg-muted-foreground/[0.02] transition-colors",children:[(0,t.jsx)("span",{className:(0,o.cn)("font-mono text-sm font-bold w-10",1===e.rank?"text-warning-amber":2===e.rank?"text-muted-foreground/60":3===e.rank?"text-warning-amber/60":"text-muted-foreground/30"),children:e.rank<=3?["","1st","2nd","3rd"][e.rank]:e.rank}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("span",{className:"font-mono text-sm font-bold uppercase tracking-wider text-foreground block truncate",children:e.name}),(0,t.jsxs)("span",{className:"font-mono text-[8px] text-muted-foreground/40 uppercase tracking-wider",children:[a.CONTRACTS[e.network]?.name||e.network," · #",e.agentId]})]}),(0,t.jsx)("span",{className:(0,o.cn)("font-mono text-sm font-bold w-16 text-center",e.elo>=1200?"text-system-green":"text-error-red"),children:e.elo}),(0,t.jsxs)("span",{className:"font-mono text-xs text-muted-foreground/60 w-16 text-center hidden md:block",children:[e.wins,"/",e.battles-e.wins]}),(0,t.jsxs)("span",{className:"font-mono text-xs text-muted-foreground/60 w-16 text-center hidden md:block",children:[e.winRate,"%"]})]},`${e.network}:${e.agentId}`))]})}function N(){return(0,t.jsxs)("div",{className:"border border-border p-5 relative animate-pulse",children:[(0,t.jsx)(u,{}),(0,t.jsx)("div",{className:"h-3 w-1/4 bg-muted-foreground/10 rounded mb-3"}),(0,t.jsx)("div",{className:"h-5 w-3/4 bg-muted-foreground/10 rounded mb-3"}),(0,t.jsx)("div",{className:"h-3 w-full bg-muted-foreground/10 rounded mb-3"}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)("div",{className:"h-3 w-16 bg-muted-foreground/10 rounded"}),(0,t.jsx)("div",{className:"h-3 w-16 bg-muted-foreground/10 rounded"}),(0,t.jsx)("div",{className:"h-3 w-16 bg-muted-foreground/10 rounded"})]})]})}function w(){let{walletAddress:e}=(0,i.useWallet)(),[a,l]=(0,r.useState)("events"),[m,p]=(0,r.useState)([]),[g,w]=(0,r.useState)(!0),[v,k]=(0,r.useState)(null),[y,C]=(0,r.useState)(null),[S,E]=(0,r.useState)(!1),[$,D]=(0,r.useState)("all"),[A,F]=(0,r.useState)(!1),P=(0,r.useRef)(!1),I=(0,r.useCallback)(()=>{w(!0),k(null),(0,d.apiListEvents)().then(e=>p(e.events||[])).catch(e=>k(e.message)).finally(()=>w(!1))},[]);(0,r.useEffect)(()=>{P.current||(P.current=!0,I())},[I]),(0,r.useEffect)(()=>{e?(0,d.apiCheckAdmin)(e).then(e=>F(e.isAdmin)).catch(()=>F(!1)):F(!1)},[e]);let R=(0,r.useMemo)(()=>"all"===$?m:m.filter(e=>e.status===$),[m,$]);return(0,t.jsx)("div",{className:"h-full w-full relative flex flex-col overflow-y-auto no-scrollbar",children:(0,t.jsx)("div",{className:"flex-1 flex flex-col items-center pt-24 pb-16 px-4 md:px-8",children:(0,t.jsxs)("div",{className:"w-full max-w-5xl",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h1",{className:"font-mono text-3xl md:text-4xl font-bold tracking-tight uppercase text-foreground",children:"ARENA"}),(0,t.jsx)("p",{className:"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 mt-2",children:"Agent battles — compete, vote, earn USDC prizes"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,t.jsx)("div",{className:"flex gap-2",children:c.map(e=>(0,t.jsx)("button",{onClick:()=>{l(e.key),C(null),E(!1)},className:(0,o.cn)("font-mono text-[10px] uppercase tracking-wider px-4 py-1.5 border transition-colors",a===e.key?"border-foreground bg-foreground text-background":"border-border text-muted-foreground hover:border-foreground/30 hover:text-foreground"),children:e.label},e.key))}),"events"===a&&!y&&A&&(0,t.jsx)("button",{onClick:()=>E(e=>!e),className:(0,o.cn)("font-mono text-[10px] uppercase tracking-wider px-4 py-1.5 border transition-colors ml-auto",S?"border-foreground bg-foreground text-background":"border-system-green/40 text-system-green hover:border-system-green hover:bg-system-green/10"),children:"+ Create Event"})]}),(0,t.jsx)(n.AnimatePresence,{mode:"wait",children:"leaderboard"===a?(0,t.jsx)(s.motion.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},exit:{opacity:0,y:-12},transition:{duration:.2},children:(0,t.jsx)(j,{})},"leaderboard"):y?(0,t.jsx)(s.motion.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},exit:{opacity:0,y:-12},transition:{duration:.2},children:(0,t.jsx)(b,{eventId:y,onBack:()=>C(null)})},"detail"):(0,t.jsxs)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col gap-5",children:[S&&(0,t.jsx)(h,{onCreated:function(){E(!1),P.current=!1,I()},onCancel:()=>E(!1)}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[x.map(e=>(0,t.jsx)("button",{onClick:()=>D(e),className:(0,o.cn)("font-mono text-[10px] uppercase tracking-wider px-3 py-1 border transition-colors",$===e?"border-foreground bg-foreground text-background":"border-border text-muted-foreground hover:border-foreground/30 hover:text-foreground"),children:e},e)),(0,t.jsxs)("span",{className:"font-mono text-[9px] uppercase tracking-widest text-muted-foreground/40 ml-2",children:[R.length," event",1!==R.length?"s":""]})]}),g?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Array.from({length:4}).map((e,r)=>(0,t.jsx)(N,{},r))}):v?(0,t.jsx)("div",{className:"border border-error-red/40 bg-error-red/5 px-4 py-3",children:(0,t.jsx)("span",{className:"font-mono text-xs uppercase tracking-wider text-error-red",children:v})}):0===R.length?(0,t.jsxs)("div",{className:"border border-border p-8 text-center relative",children:[(0,t.jsx)(u,{}),(0,t.jsx)("span",{className:"font-mono text-xs uppercase tracking-widest text-muted-foreground/40",children:"all"===$?"No events yet":`No ${$} events`})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:R.map(e=>(0,t.jsx)(f,{event:e,onClick:()=>C(e.id)},e.id))})]},"events")})]})})})}e.s(["default",()=>w])}]);
module.exports=[69562,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(46271),f=a.i(62036),g=a.i(97895),h=a.i(53250),i=a.i(83103),j=a.i(85085);function k({opacity:a=20}){let c=`border-foreground/${a}`;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:`absolute top-2 left-2 w-3 h-3 border-t border-l ${c}`}),(0,b.jsx)("div",{className:`absolute top-2 right-2 w-3 h-3 border-t border-r ${c}`}),(0,b.jsx)("div",{className:`absolute bottom-2 left-2 w-3 h-3 border-b border-l ${c}`}),(0,b.jsx)("div",{className:`absolute bottom-2 right-2 w-3 h-3 border-b border-r ${c}`})]})}function l(){let a=(0,d.useSearchParams)(),l=(0,d.useRouter)(),{walletAddress:m,connect:n,isConnecting:o}=(0,j.useWallet)(),p=a.get("network")||"",q=a.get("agentId")||"",r=a.get("hireId"),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(r),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!0),[I,J]=(0,c.useState)(null),[K,L]=(0,c.useState)(0),[M,N]=(0,c.useState)(0),O=(0,c.useRef)(null),P=(0,c.useRef)(null),Q=(0,c.useRef)(null),R=(0,c.useCallback)(()=>{O.current?.scrollIntoView({behavior:"smooth"})},[]);async function S(){if(!w||!A.trim()||E)return;let a=A.trim(),b=C.length>0?[...C]:void 0,c={role:"user",text:a,timestamp:new Date().toISOString(),hasFiles:!!b};z(a=>[...a,c]),B(""),D([]),F(!0),J(null),Q.current&&(Q.current.style.height="auto");try{let c=await (0,h.apiWorkspaceCall)(w,a,b),d={role:"agent",text:c.response||"(No response)",timestamp:new Date().toISOString()};z(a=>[...a,d]),L(c.callsUsed),N(c.callsTotal)}catch(b){let a=b instanceof Error?b.message:"Failed to send message";J(a),z(b=>[...b,{role:"agent",text:`Error: ${a}`,timestamp:new Date().toISOString()}])}finally{F(!1)}}async function T(){if(w)try{await (0,h.apiWorkspaceClear)(w),z([])}catch{}}if((0,c.useEffect)(()=>{R()},[y,R]),(0,c.useEffect)(()=>{p&&q?async function(){try{let a=await (0,h.apiGetAgent)(p,q);t(a);let b=r;if(!b&&m){let a=await (0,h.apiCheckActiveHire)(m,p,q);a.active&&a.hire&&(b=a.hire.hireId)}if(b){x(b);let a=await (0,h.apiGetHireStatus)(b);v(a),L(Number(a.callsUsed)||0),N(Number(a.callsTotal)||0);let c=await (0,h.apiWorkspaceHistory)(b);if(c.history&&c.history.length>0){let a=[];for(let b of c.history)a.push({role:"user",text:b.userMessage,timestamp:b.timestamp,hasFiles:b.hasFiles}),a.push({role:"agent",text:b.agentResponse,timestamp:b.timestamp});z(a)}}}catch(a){J(a instanceof Error?a.message:"Failed to load workspace")}finally{H(!1)}}():H(!1)},[p,q,r,m]),!p||!q)return(0,b.jsx)("div",{className:"h-full w-full relative flex flex-col overflow-hidden",children:(0,b.jsx)("div",{className:"flex-1 flex flex-col items-center justify-center",children:(0,b.jsx)("div",{className:"border border-error-red/40 bg-error-red/5 px-6 py-4",children:(0,b.jsx)("span",{className:"font-mono text-xs uppercase tracking-wider text-error-red",children:"Missing network or agentId parameter"})})})});if(G)return(0,b.jsx)("div",{className:"h-full w-full relative flex flex-col overflow-hidden",children:(0,b.jsx)("div",{className:"flex-1 flex flex-col items-center pt-24 pb-16 px-4 md:px-8",children:(0,b.jsxs)("div",{className:"w-full max-w-3xl animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-8 w-48 bg-muted-foreground/10 rounded"}),(0,b.jsx)("div",{className:"h-24 bg-muted-foreground/10 rounded"}),(0,b.jsx)("div",{className:"flex-1 h-64 bg-muted-foreground/10 rounded"})]})})});if(!m)return(0,b.jsx)("div",{className:"h-full w-full relative flex flex-col overflow-hidden",children:(0,b.jsx)("div",{className:"flex-1 flex flex-col items-center justify-center px-4",children:(0,b.jsxs)("div",{className:"border border-border p-8 relative text-center max-w-md",children:[(0,b.jsx)(k,{}),(0,b.jsx)("h2",{className:"font-mono text-lg font-bold uppercase tracking-wider text-foreground mb-2",children:"CONNECT WALLET"}),(0,b.jsx)("p",{className:"font-mono text-xs text-muted-foreground mb-6",children:"Connect your wallet to access the workspace"}),(0,b.jsx)("button",{onClick:n,disabled:o,className:"font-mono text-xs uppercase tracking-widest bg-foreground text-background px-8 py-3 hover:opacity-90 disabled:opacity-30",children:o?"CONNECTING...":"CONNECT"})]})})});if(!w||!u&&!G)return(0,b.jsx)("div",{className:"h-full w-full relative flex flex-col overflow-hidden",children:(0,b.jsx)("div",{className:"flex-1 flex flex-col items-center justify-center px-4",children:(0,b.jsxs)("div",{className:"border border-border p-8 relative text-center max-w-md",children:[(0,b.jsx)(k,{}),(0,b.jsx)("h2",{className:"font-mono text-lg font-bold uppercase tracking-wider text-foreground mb-2",children:"NO ACTIVE HIRE"}),(0,b.jsx)("p",{className:"font-mono text-xs text-muted-foreground mb-6",children:"You need to hire this agent before using the workspace"}),(0,b.jsx)("button",{onClick:()=>l.push(`/hire?network=${p}&agentId=${q}`),className:"font-mono text-xs uppercase tracking-widest bg-foreground text-background px-8 py-3 hover:opacity-90",children:"HIRE AGENT"})]})})});let U=u&&new Date(u.expiresAt)<new Date,V=K>=M,W=!E&&!U&&!V&&u?.status==="active",X=Math.max(0,M-K),Y=M>0?Math.min(100,K/M*100):0,Z=i.CONTRACTS[p]?.name||p,$=s?.a2aEndpoint?"A2A":s?.mcpEndpoint?"MCP":"HTTP";return(0,b.jsxs)("div",{className:"h-[calc(100vh-64px)] w-full relative flex flex-col overflow-hidden",children:[(0,b.jsx)("div",{className:"border-b border-border px-4 md:px-8 py-3 flex-shrink-0",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,b.jsx)("button",{onClick:()=>l.back(),className:"font-mono text-xs uppercase tracking-widest text-muted-foreground hover:text-foreground transition-colors flex-shrink-0",children:"â†"}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:(0,g.cn)("h-2 w-2 rounded-full flex-shrink-0",s?.status==="active"?"bg-system-green":"bg-error-red")}),(0,b.jsx)("span",{className:"font-mono text-sm font-bold uppercase tracking-wider text-foreground truncate",children:s?.name||"Agent"}),(0,b.jsxs)("span",{className:"font-mono text-[9px] text-muted-foreground/50 flex-shrink-0",children:["#",q]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[(0,b.jsx)("span",{className:"font-mono text-[8px] uppercase tracking-wider text-muted-foreground/40",children:Z}),(0,b.jsx)("span",{className:"font-mono text-[8px] uppercase tracking-wider text-info-blue/60",children:$})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 flex-shrink-0",children:[(0,b.jsxs)("div",{className:"hidden sm:flex flex-col items-end gap-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"font-mono text-[9px] uppercase tracking-wider text-muted-foreground/50",children:[X.toLocaleString()," calls left"]}),(0,b.jsxs)("span",{className:(0,g.cn)("font-mono text-[9px] uppercase tracking-wider",Y>90?"text-error-red":Y>70?"text-warning-amber":"text-system-green"),children:[Y.toFixed(0),"%"]})]}),(0,b.jsx)("div",{className:"w-32 h-1 bg-muted-foreground/10 overflow-hidden",children:(0,b.jsx)("div",{className:(0,g.cn)("h-full transition-all",Y>90?"bg-error-red":Y>70?"bg-warning-amber":"bg-system-green"),style:{width:`${Y}%`}})})]}),(0,b.jsx)("button",{onClick:T,className:"font-mono text-[9px] uppercase tracking-widest px-3 py-1.5 border border-border hover:border-foreground/30 text-muted-foreground hover:text-foreground transition-colors",title:"Clear conversation",children:"NEW CHAT"})]})]})}),(U||V)&&(0,b.jsx)("div",{className:"border-b border-error-red/30 bg-error-red/5 px-4 py-2 flex-shrink-0",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-mono text-xs uppercase tracking-wider text-error-red",children:U?"Hire expired":"No calls remaining"}),(0,b.jsx)("button",{onClick:()=>l.push(`/hire?network=${p}&agentId=${q}`),className:"font-mono text-[9px] uppercase tracking-widest px-3 py-1 bg-error-red/10 border border-error-red/30 text-error-red hover:bg-error-red/20 transition-colors",children:"RENEW"})]})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto no-scrollbar px-4 md:px-8",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto py-6 space-y-1",children:[0===y.length?(0,b.jsx)("div",{className:"flex flex-col items-center justify-center pt-24 pb-16",children:(0,b.jsxs)("div",{className:"border border-border/40 p-8 relative text-center max-w-md",children:[(0,b.jsx)(k,{opacity:10}),(0,b.jsx)("div",{className:"font-mono text-3xl text-foreground/10 mb-4",children:">_"}),(0,b.jsx)("h3",{className:"font-mono text-sm font-bold uppercase tracking-widest text-foreground/40 mb-2",children:"WORKSPACE READY"}),(0,b.jsxs)("p",{className:"font-mono text-[10px] text-muted-foreground/40 leading-relaxed",children:["Send a message to start interacting with"," ",(0,b.jsx)("span",{className:"text-foreground/60",children:s?.name||"this agent"}),". You can also attach files for the agent to process."]})]})}):(0,b.jsx)(f.AnimatePresence,{initial:!1,children:y.map((a,c)=>(0,b.jsxs)(e.motion.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.15},className:(0,g.cn)("py-4",c>0&&y[c-1].role!==a.role?"border-t border-border/20":""),children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("span",{className:(0,g.cn)("font-mono text-[9px] uppercase tracking-widest font-bold","user"===a.role?"text-info-blue":"text-system-green"),children:"user"===a.role?"YOU":s?.name?.toUpperCase()||"AGENT"}),(0,b.jsx)("span",{className:"font-mono text-[8px] text-muted-foreground/30",children:new Date(a.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),a.hasFiles&&(0,b.jsx)("span",{className:"font-mono text-[8px] text-warning-amber/60 border border-warning-amber/20 px-1",children:"FILES"})]}),(0,b.jsx)("div",{className:(0,g.cn)("font-mono text-[12px] leading-relaxed whitespace-pre-wrap break-words","user"===a.role?"text-foreground/80":"text-foreground",a.text.startsWith("Error:")?"text-error-red":""),children:a.text})]},c))}),E&&(0,b.jsxs)(e.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"py-4 border-t border-border/20",children:[(0,b.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,b.jsx)("span",{className:"font-mono text-[9px] uppercase tracking-widest font-bold text-system-green",children:s?.name?.toUpperCase()||"AGENT"})}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("span",{className:"h-1.5 w-1.5 bg-system-green/60 rounded-full animate-pulse"}),(0,b.jsx)("span",{className:"h-1.5 w-1.5 bg-system-green/60 rounded-full animate-pulse [animation-delay:150ms]"}),(0,b.jsx)("span",{className:"h-1.5 w-1.5 bg-system-green/60 rounded-full animate-pulse [animation-delay:300ms]"}),(0,b.jsx)("span",{className:"font-mono text-[10px] text-muted-foreground/40 ml-2",children:"Processing..."})]})]}),(0,b.jsx)("div",{ref:O})]})}),(0,b.jsx)("div",{className:"border-t border-border px-4 md:px-8 py-4 flex-shrink-0 bg-background",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[C.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:C.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-1.5 border border-border px-2 py-1 bg-muted-foreground/5",children:[(0,b.jsx)("span",{className:"font-mono text-[9px] text-foreground/70 truncate max-w-[120px]",children:a.name}),(0,b.jsx)("button",{onClick:()=>{D(a=>a.filter((a,b)=>b!==c))},className:"font-mono text-[9px] text-error-red hover:text-error-red/80",children:"x"})]},c))}),I&&(0,b.jsx)("div",{className:"border border-error-red/30 bg-error-red/5 px-3 py-2 mb-3",children:(0,b.jsx)("span",{className:"font-mono text-[10px] text-error-red",children:I})}),(0,b.jsxs)("div",{className:"flex items-end gap-3",children:[(0,b.jsx)("button",{onClick:()=>P.current?.click(),disabled:!W,className:"font-mono text-xs px-3 py-2.5 border border-border hover:border-foreground/30 text-muted-foreground hover:text-foreground transition-colors disabled:opacity-30 disabled:cursor-not-allowed flex-shrink-0",title:"Attach files",children:"+"}),(0,b.jsx)("input",{ref:P,type:"file",multiple:!0,onChange:function(a){let b=a.target.files;b&&(Array.from(b).forEach(a=>{let b=new FileReader;b.onload=()=>{let c=b.result.split(",")[1];D(b=>[...b,{name:a.name,data:c,mimeType:a.type||"application/octet-stream"}])},b.readAsDataURL(a)}),a.target.value="")},className:"hidden"}),(0,b.jsx)("div",{className:"flex-1 border border-border focus-within:border-foreground/30 transition-colors relative",children:(0,b.jsx)("textarea",{ref:Q,value:A,onChange:function(a){B(a.target.value);let b=a.target;b.style.height="auto",b.style.height=Math.min(b.scrollHeight,160)+"px"},onKeyDown:function(a){"Enter"!==a.key||a.shiftKey||(a.preventDefault(),S())},disabled:!W,placeholder:W?"Type a message... (Shift+Enter for new line)":"Cannot send messages",rows:1,className:"w-full bg-transparent font-mono text-xs text-foreground placeholder:text-muted-foreground/30 px-4 py-3 resize-none outline-none disabled:opacity-30 disabled:cursor-not-allowed",style:{maxHeight:"160px"}})}),(0,b.jsx)("button",{onClick:S,disabled:!W||!A.trim(),className:(0,g.cn)("font-mono text-xs uppercase tracking-widest px-6 py-2.5 transition-colors flex-shrink-0",W&&A.trim()?"bg-foreground text-background hover:opacity-90":"bg-muted-foreground/10 text-muted-foreground/30 cursor-not-allowed"),children:E?"...":"SEND"})]}),(0,b.jsxs)("div",{className:"sm:hidden mt-3 flex items-center justify-between",children:[(0,b.jsxs)("span",{className:"font-mono text-[8px] uppercase tracking-wider text-muted-foreground/40",children:[X.toLocaleString()," / ",M.toLocaleString()," calls remaining"]}),(0,b.jsx)("div",{className:"w-20 h-1 bg-muted-foreground/10 overflow-hidden",children:(0,b.jsx)("div",{className:(0,g.cn)("h-full",Y>90?"bg-error-red":Y>70?"bg-warning-amber":"bg-system-green"),style:{width:`${Y}%`}})})]})]})})]})}function m(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"h-full w-full relative flex flex-col overflow-hidden",children:(0,b.jsx)("div",{className:"flex-1 flex flex-col items-center pt-24 pb-16 px-4 md:px-8",children:(0,b.jsxs)("div",{className:"w-full max-w-3xl animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-8 w-48 bg-muted-foreground/10 rounded"}),(0,b.jsx)("div",{className:"h-24 bg-muted-foreground/10 rounded"}),(0,b.jsx)("div",{className:"flex-1 h-64 bg-muted-foreground/10 rounded"})]})})}),children:(0,b.jsx)(l,{})})}a.s(["default",()=>m])}];

//# sourceMappingURL=app_workspace_page_tsx_b600575a._.js.map
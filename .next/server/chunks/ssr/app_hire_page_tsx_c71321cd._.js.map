{"version":3,"sources":["../../../../app/hire/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, Suspense } from \"react\"\nimport { useSearchParams, useRouter } from \"next/navigation\"\nimport { motion } from \"motion/react\"\nimport { cn } from \"@/lib/utils\"\nimport { CONTRACTS, CHAIN_USDC, PAYMENT_CHAINS, USDC_DECIMALS, USDC_ABI } from \"@/lib/deploy-constants\"\nimport { apiGetAgent, apiGetPlans, apiRecordHire, apiCheckActiveHire, apiBridgeInitiate, type HirePlan } from \"@/lib/api\"\nimport { selectFacilitator, facinetExecuteContract } from \"@/lib/facinet\"\nimport { useWallet } from \"@/components/wallet-provider\"\nimport { ethers } from \"ethers\"\n\n// ---- Types ----\ninterface Agent {\n  agentId: string\n  name: string\n  description: string\n  url: string\n  imageUrl: string\n  network: string\n  hirePrice: string\n  status: string\n  ownerAddress: string\n  agentWalletAddress: string\n  skills: string[]\n  mcpEndpoint: string\n  a2aEndpoint: string\n}\n\nconst PLAN_KEYS = [\"single\", \"daily\", \"monthly\", \"biannual\"] as const\nconst PLAN_ICONS: Record<string, string> = {\n  single: \"1\",\n  daily: \"24h\",\n  monthly: \"30d\",\n  biannual: \"6mo\",\n}\nconst PLAN_DISCOUNTS: Record<string, string> = {\n  single: \"\",\n  daily: \"20% OFF\",\n  monthly: \"40% OFF\",\n  biannual: \"55% OFF\",\n}\n\nfunction CornerBrackets({ opacity = 20 }: { opacity?: number }) {\n  const cls = `border-foreground/${opacity}`\n  return (\n    <>\n      <div className={`absolute top-2 left-2 w-3 h-3 border-t border-l ${cls}`} />\n      <div className={`absolute top-2 right-2 w-3 h-3 border-t border-r ${cls}`} />\n      <div className={`absolute bottom-2 left-2 w-3 h-3 border-b border-l ${cls}`} />\n      <div className={`absolute bottom-2 right-2 w-3 h-3 border-b border-r ${cls}`} />\n    </>\n  )\n}\n\nfunction HireInner() {\n  const searchParams = useSearchParams()\n  const router = useRouter()\n  const { walletAddress, isConnecting, connect } = useWallet()\n\n  const network = searchParams.get(\"network\") || \"\"\n  const agentId = searchParams.get(\"agentId\") || \"\"\n\n  const [agent, setAgent] = useState<Agent | null>(null)\n  const [plans, setPlans] = useState<Record<string, HirePlan> | null>(null)\n  const [perCallPrice, setPerCallPrice] = useState(0)\n  const [relayerAddress, setRelayerAddress] = useState(\"\")\n  const [isFree, setIsFree] = useState(false)\n  const [selectedPlan, setSelectedPlan] = useState<string | null>(null)\n  const [selectedChain, setSelectedChain] = useState(\"fuji\")\n  const [loading, setLoading] = useState(true)\n  const [paying, setPaying] = useState(false)\n  const [payStatus, setPayStatus] = useState<string | null>(null)\n  const [error, setError] = useState<string | null>(null)\n  const [existingHire, setExistingHire] = useState<string | null>(null)\n\n  // Fetch agent + plans\n  useEffect(() => {\n    if (!network || !agentId) { setLoading(false); return }\n    async function load() {\n      try {\n        const [agentData, planData] = await Promise.all([\n          apiGetAgent(network, agentId),\n          apiGetPlans(network, agentId),\n        ])\n        setAgent(agentData as unknown as Agent)\n        if (planData.free) {\n          setIsFree(true)\n        } else {\n          setPlans(planData.plans)\n          setPerCallPrice(planData.perCallPrice || 0)\n          setSelectedPlan(\"single\")\n          if (planData.relayerAddress) {\n            setRelayerAddress(planData.relayerAddress)\n          }\n        }\n      } catch (e: unknown) {\n        setError(e instanceof Error ? e.message : \"Failed to load agent\")\n      } finally {\n        setLoading(false)\n      }\n    }\n    load()\n  }, [network, agentId])\n\n  // Check existing active hire\n  useEffect(() => {\n    if (!walletAddress || !network || !agentId) return\n    apiCheckActiveHire(walletAddress, network, agentId)\n      .then((data) => {\n        if (data.active && data.hire) {\n          setExistingHire(data.hire.hireId)\n        }\n      })\n      .catch(() => {})\n  }, [walletAddress, network, agentId])\n\n  // Gasless x402 payment handler\n  async function handlePay() {\n    if (!walletAddress || !agent || !selectedPlan || !plans) return\n\n    const plan = plans[selectedPlan]\n    if (!plan) return\n\n    setPaying(true)\n    setPayStatus(\"Preparing gasless payment...\")\n    setError(null)\n\n    try {\n      const chainConfig = CONTRACTS[selectedChain]\n      if (!chainConfig) throw new Error(`Unknown chain: ${selectedChain}`)\n\n      const usdcAddress = CHAIN_USDC[selectedChain]\n      if (!usdcAddress) throw new Error(`No USDC address for chain: ${selectedChain}`)\n\n      const recipientAddress = selectedChain === \"fuji\"\n        ? agent.agentWalletAddress\n        : relayerAddress\n\n      if (!recipientAddress) {\n        throw new Error(selectedChain === \"fuji\"\n          ? \"Agent has no wallet address configured\"\n          : \"Relayer address not available for bridging\")\n      }\n\n      const amount = ethers.parseUnits(plan.price.toString(), USDC_DECIMALS)\n\n      setPayStatus(`Selecting facilitator on ${chainConfig.name}...`)\n      const facConfig = { network: chainConfig.facinetNetwork, chainId: chainConfig.chainId }\n      const facilitator = await selectFacilitator(facConfig)\n\n      setPayStatus(`Sending $${plan.price.toFixed(2)} USDC via x402 (gas-free)...`)\n      const result = await facinetExecuteContract(facConfig, {\n        contractAddress: usdcAddress as `0x${string}`,\n        functionName: \"transfer\",\n        functionArgs: [recipientAddress, amount.toString()],\n        abi: USDC_ABI,\n      }, facilitator)\n\n      const txHash = result.txHash\n\n      // If non-Fuji chain, initiate CCTP bridge to settle on Avalanche Fuji\n      let bridgeId = \"\"\n      if (selectedChain !== \"fuji\" && txHash) {\n        setPayStatus(\"Initiating CCTP bridge to Avalanche Fuji...\")\n        try {\n          const bridgeResult = await apiBridgeInitiate({\n            sourceChain: selectedChain,\n            paymentTxHash: txHash,\n            amount: plan.price.toString(),\n            finalRecipient: agent.agentWalletAddress,\n            purpose: \"hire\",\n          })\n          bridgeId = bridgeResult.bridgeId\n        } catch (bridgeErr) {\n          console.error(\"Bridge initiation failed:\", bridgeErr)\n          // Don't block hire â€” bridge runs async, payment already confirmed\n        }\n      }\n\n      setPayStatus(\"Recording hire...\")\n      const hireResult = await apiRecordHire({\n        network,\n        agentId,\n        buyerAddress: walletAddress,\n        plan: selectedPlan,\n        paymentTxHash: txHash,\n        callsTotal: plan.calls,\n        daysValid: plan.days,\n        pricePaid: plan.price.toString(),\n        paymentChain: selectedChain,\n        bridgeId,\n      })\n\n      setPayStatus(\"Success! Redirecting to workspace...\")\n\n      setTimeout(() => {\n        router.push(`/workspace?network=${network}&agentId=${agentId}&hireId=${hireResult.hireId}`)\n      }, 1500)\n\n    } catch (e: unknown) {\n      const msg = e instanceof Error ? e.message : String(e)\n      setError(msg)\n      setPayStatus(null)\n    } finally {\n      setPaying(false)\n    }\n  }\n\n  // Free hire handler\n  async function handleFreeHire() {\n    if (!walletAddress) return\n    setPaying(true)\n    setError(null)\n\n    try {\n      const hireResult = await apiRecordHire({\n        network,\n        agentId,\n        buyerAddress: walletAddress,\n        plan: \"free\",\n        paymentTxHash: \"free\",\n        callsTotal: 999999,\n        daysValid: 365,\n        pricePaid: \"0\",\n        paymentChain: \"fuji\",\n      })\n\n      router.push(`/workspace?network=${network}&agentId=${agentId}&hireId=${hireResult.hireId}`)\n    } catch (e: unknown) {\n      setError(e instanceof Error ? e.message : \"Failed to record hire\")\n    } finally {\n      setPaying(false)\n    }\n  }\n\n  // ---- Missing params ----\n  if (!network || !agentId) {\n    return (\n      <div className=\"h-full w-full relative flex flex-col overflow-y-auto no-scrollbar\">\n        <div className=\"flex-1 flex flex-col items-center justify-center\">\n          <div className=\"border border-error-red/40 bg-error-red/5 px-6 py-4\">\n            <span className=\"font-mono text-xs uppercase tracking-wider text-error-red\">Missing network or agentId parameter</span>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // ---- Loading ----\n  if (loading) {\n    return (\n      <div className=\"h-full w-full relative flex flex-col overflow-y-auto no-scrollbar\">\n        <div className=\"flex-1 flex flex-col items-center pt-24 pb-16 px-4 md:px-8\">\n          <div className=\"w-full max-w-3xl animate-pulse space-y-4\">\n            <div className=\"h-8 w-48 bg-muted-foreground/10 rounded\" />\n            <div className=\"h-32 bg-muted-foreground/10 rounded\" />\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              {[1, 2, 3, 4].map((i) => <div key={i} className=\"h-40 bg-muted-foreground/10 rounded\" />)}\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (!agent) {\n    return (\n      <div className=\"h-full w-full relative flex flex-col overflow-y-auto no-scrollbar\">\n        <div className=\"flex-1 flex flex-col items-center justify-center\">\n          <div className=\"border border-error-red/40 bg-error-red/5 px-6 py-4\">\n            <span className=\"font-mono text-xs uppercase tracking-wider text-error-red\">{error || \"Agent not found\"}</span>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  const isActive = agent.status === \"active\"\n  const networkName = CONTRACTS[network]?.name || network\n\n  return (\n    <div className=\"h-full w-full relative flex flex-col overflow-y-auto no-scrollbar\">\n      <div className=\"flex-1 flex flex-col items-center pt-24 pb-16 px-4 md:px-8\">\n        <div className=\"w-full max-w-3xl\">\n          {/* Back */}\n          <button\n            onClick={() => router.back()}\n            className=\"font-mono text-xs uppercase tracking-widest text-muted-foreground hover:text-foreground transition-colors mb-6\"\n          >\n            &larr; Back\n          </button>\n\n          {/* Page title */}\n          <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }}>\n            <h1 className=\"font-mono text-3xl md:text-4xl font-bold tracking-tight uppercase text-foreground mb-2\">\n              HIRE AGENT\n            </h1>\n            <p className=\"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 mb-8\">\n              Select a plan and pay with USDC (gas-free via x402)\n            </p>\n          </motion.div>\n\n          {/* Agent Info Card */}\n          <motion.div initial={{ opacity: 0, y: 12 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.05 }}>\n            <div className=\"border border-border p-5 relative mb-8\">\n              <CornerBrackets />\n              <div className=\"flex items-center gap-2 mb-2\">\n                <span className={cn(\"h-2.5 w-2.5 rounded-full\", isActive ? \"bg-system-green\" : \"bg-error-red\")} />\n                <span className=\"font-mono text-lg font-bold uppercase tracking-wider text-foreground\">{agent.name}</span>\n                <span className=\"font-mono text-[10px] text-muted-foreground/60\">#{agentId}</span>\n              </div>\n              <div className=\"flex items-center gap-2 mb-3\">\n                <span className=\"font-mono text-[9px] uppercase tracking-wider text-muted-foreground/50 border border-border px-1.5 py-0.5\">{networkName}</span>\n                {(agent.mcpEndpoint || agent.a2aEndpoint) && (\n                  <span className=\"font-mono text-[9px] uppercase tracking-wider text-info-blue border border-info-blue/30 px-1.5 py-0.5\">\n                    {agent.a2aEndpoint ? \"A2A\" : \"MCP\"}\n                  </span>\n                )}\n              </div>\n              {agent.description && (\n                <p className=\"font-mono text-[11px] text-muted-foreground leading-relaxed\">{agent.description}</p>\n              )}\n            </div>\n          </motion.div>\n\n          {/* Existing hire check */}\n          {existingHire && (\n            <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"border border-system-green/40 bg-system-green/5 px-4 py-3 mb-6\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"font-mono text-xs uppercase tracking-wider text-system-green\">You already have an active hire for this agent</span>\n                <button\n                  onClick={() => router.push(`/workspace?network=${network}&agentId=${agentId}&hireId=${existingHire}`)}\n                  className=\"font-mono text-[10px] uppercase tracking-widest px-4 py-1.5 bg-system-green/10 border border-system-green/40 text-system-green hover:bg-system-green/20 transition-colors\"\n                >\n                  OPEN WORKSPACE\n                </button>\n              </div>\n            </motion.div>\n          )}\n\n          {/* Free agent */}\n          {isFree ? (\n            <motion.div initial={{ opacity: 0, y: 12 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }}>\n              <div className=\"border border-system-green/30 p-6 relative text-center\">\n                <CornerBrackets />\n                <span className=\"font-mono text-2xl font-bold text-system-green block mb-2\">FREE</span>\n                <p className=\"font-mono text-xs text-muted-foreground mb-4\">This agent is free to use. No payment required.</p>\n                {!walletAddress ? (\n                  <button onClick={connect} disabled={isConnecting} className=\"font-mono text-xs uppercase tracking-widest bg-foreground text-background px-8 py-3 hover:opacity-90 disabled:opacity-30\">\n                    {isConnecting ? \"CONNECTING...\" : \"CONNECT WALLET\"}\n                  </button>\n                ) : (\n                  <button onClick={handleFreeHire} disabled={paying} className=\"font-mono text-xs uppercase tracking-widest bg-foreground text-background px-8 py-3 hover:opacity-90 disabled:opacity-30\">\n                    {paying ? \"SETTING UP...\" : \"START USING\"}\n                  </button>\n                )}\n              </div>\n            </motion.div>\n          ) : plans ? (\n            <>\n              {/* Pricing Plans */}\n              <motion.div initial={{ opacity: 0, y: 12 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }}>\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <span className=\"font-mono text-sm font-bold uppercase tracking-widest text-foreground\">Select Plan</span>\n                  <span className=\"font-mono text-[10px] text-muted-foreground/50\">${perCallPrice.toFixed(4)} per call</span>\n                  <div className=\"flex-1 h-[1px] bg-border\" />\n                </div>\n\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8\">\n                  {PLAN_KEYS.map((key) => {\n                    const plan = plans[key]\n                    if (!plan) return null\n                    const isSelected = selectedPlan === key\n                    const discount = PLAN_DISCOUNTS[key]\n\n                    return (\n                      <button\n                        key={key}\n                        onClick={() => setSelectedPlan(key)}\n                        className={cn(\n                          \"border p-4 relative text-left transition-colors\",\n                          isSelected\n                            ? \"border-foreground bg-foreground/5\"\n                            : \"border-border hover:border-foreground/30\"\n                        )}\n                      >\n                        <CornerBrackets opacity={isSelected ? 30 : 10} />\n                        {discount && (\n                          <span className=\"absolute top-0 right-0 font-mono text-[8px] uppercase tracking-wider text-system-green bg-system-green/10 border-l border-b border-system-green/30 px-1.5 py-0.5\">\n                            {discount}\n                          </span>\n                        )}\n                        <span className=\"font-mono text-lg font-bold text-foreground/40 block mb-3\">{PLAN_ICONS[key]}</span>\n                        <span className=\"font-mono text-xs font-bold uppercase tracking-wider text-foreground block mb-1\">{plan.label}</span>\n                        <span className=\"font-mono text-lg font-bold text-foreground block\">${plan.price.toFixed(2)}</span>\n                        <span className=\"font-mono text-[9px] text-muted-foreground/50 block mt-1\">\n                          {plan.calls.toLocaleString()} call{plan.calls !== 1 ? \"s\" : \"\"} / {plan.days}d\n                        </span>\n                      </button>\n                    )\n                  })}\n                </div>\n              </motion.div>\n\n              {/* Chain Selector */}\n              <motion.div initial={{ opacity: 0, y: 12 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.12 }}>\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <span className=\"font-mono text-sm font-bold uppercase tracking-widest text-foreground\">Pay On</span>\n                  <div className=\"flex-1 h-[1px] bg-border\" />\n                </div>\n\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 mb-8\">\n                  {PAYMENT_CHAINS.map((chain) => {\n                    const isSelected = selectedChain === chain.key\n                    return (\n                      <button\n                        key={chain.key}\n                        onClick={() => setSelectedChain(chain.key)}\n                        className={cn(\n                          \"border p-3 relative text-left transition-colors\",\n                          isSelected\n                            ? \"border-foreground bg-foreground/5\"\n                            : \"border-border hover:border-foreground/30\"\n                        )}\n                      >\n                        <span className=\"font-mono text-xs font-bold uppercase tracking-wider text-foreground block\">\n                          {chain.label}\n                        </span>\n                        {chain.cctp && (\n                          <span className=\"font-mono text-[8px] uppercase tracking-wider text-muted-foreground/50 mt-1 block\">\n                            CCTP Bridge to Fuji\n                          </span>\n                        )}\n                        {!chain.cctp && (\n                          <span className=\"font-mono text-[8px] uppercase tracking-wider text-system-green/60 mt-1 block\">\n                            Direct Payment\n                          </span>\n                        )}\n                      </button>\n                    )\n                  })}\n                </div>\n              </motion.div>\n\n              {/* Payment */}\n              <motion.div initial={{ opacity: 0, y: 12 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }}>\n                <div className=\"border border-border p-5 relative\">\n                  <CornerBrackets />\n                  {!walletAddress ? (\n                    <div className=\"text-center py-2\">\n                      <p className=\"font-mono text-xs text-muted-foreground mb-4 uppercase tracking-widest\">Connect wallet to pay</p>\n                      <button onClick={connect} disabled={isConnecting} className=\"font-mono text-xs uppercase tracking-widest bg-foreground text-background px-8 py-3 hover:opacity-90 disabled:opacity-30\">\n                        {isConnecting ? \"CONNECTING...\" : \"CONNECT WALLET\"}\n                      </button>\n                    </div>\n                  ) : selectedPlan && plans[selectedPlan] ? (\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <span className=\"font-mono text-[10px] uppercase tracking-widest text-muted-foreground/60 block mb-1\">Total</span>\n                        <span className=\"font-mono text-2xl font-bold text-foreground\">${plans[selectedPlan].price.toFixed(2)}</span>\n                        <span className=\"font-mono text-xs text-muted-foreground ml-2\">USDC</span>\n                      </div>\n                      <button\n                        onClick={handlePay}\n                        disabled={paying}\n                        className=\"font-mono text-xs uppercase tracking-widest bg-foreground text-background px-8 py-3 hover:opacity-90 disabled:opacity-30\"\n                      >\n                        {paying ? \"PROCESSING...\" : \"PAY & START\"}\n                      </button>\n                    </div>\n                  ) : null}\n\n                  {payStatus && (\n                    <div className=\"mt-4 border-t border-border pt-3\">\n                      <span className=\"font-mono text-xs uppercase tracking-wider text-info-blue\">{payStatus}</span>\n                    </div>\n                  )}\n\n                  {error && (\n                    <div className=\"mt-4 border border-error-red/40 bg-error-red/5 px-4 py-3\">\n                      <span className=\"font-mono text-xs uppercase tracking-wider text-error-red\">{error}</span>\n                    </div>\n                  )}\n                </div>\n\n                <p className=\"font-mono text-[9px] text-muted-foreground/40 uppercase tracking-widest mt-3 text-center\">\n                  Gas-free x402 payment via Facinet{selectedChain !== \"fuji\" ? \" \\u2014 CCTP bridge settles on Avalanche Fuji\" : \"\"}\n                </p>\n              </motion.div>\n            </>\n          ) : null}\n\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default function HirePage() {\n  return (\n    <Suspense fallback={\n      <div className=\"h-full w-full relative flex flex-col overflow-y-auto no-scrollbar\">\n        <div className=\"flex-1 flex flex-col items-center pt-24 pb-16 px-4 md:px-8\">\n          <div className=\"w-full max-w-3xl animate-pulse space-y-4\">\n            <div className=\"h-8 w-48 bg-muted-foreground/10 rounded\" />\n            <div className=\"h-32 bg-muted-foreground/10 rounded\" />\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              {[1, 2, 3, 4].map((i) => <div key={i} className=\"h-40 bg-muted-foreground/10 rounded\" />)}\n            </div>\n          </div>\n        </div>\n      </div>\n    }>\n      <HireInner />\n    </Suspense>\n  )\n}\n"],"names":[],"mappings":"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"}